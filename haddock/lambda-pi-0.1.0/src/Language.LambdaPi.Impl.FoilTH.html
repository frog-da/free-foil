<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds                  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies         #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs                      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs               #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures             #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase                 #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LiberalTypeSynonyms        #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings          #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes                 #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables        #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving         #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell            #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications           #-}</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- | Foil implementation of the \(\lambda\Pi\)-calculus (with pairs)</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- using Template Haskell to reduce boilerplate.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Template Haskell helpers __generate__ the following:</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- 1. Scope-safe AST, generated from a raw definition. See 'FoilTerm', 'FoilScopedTerm', and 'FoilPattern'.</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- 2. Conversion between scope-safe and raw term representation (the latter is generated via BNFC), see 'toFoilTerm' and 'fromFoilTerm'.</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- 3. Helper functions for patterns. See 'extendScopeFoilPattern' and 'withRefreshedFoilPattern'.</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- The following is implemented __manually__ in this module:</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- 1. Correct capture-avoiding substitution (see 'substitute').</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- 2. Computation of weak head normal form (WHNF), see 'whnf'.</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- 3. Entry point, gluing everything together. See 'defaultMain'.</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- The following is __not implemented__:</span><span>
</span><span id="line-31"></span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- 1. \(\alpha\)-equivalence checks and \(\alpha\)-normalization helpers.</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- This implementation supports (nested) patterns for pairs.</span><span>
</span><span id="line-35"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.LambdaPi.Impl.FoilTH</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Foil</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Foil.TH</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html"><span class="hs-identifier">Language.LambdaPi.Syntax.Abs</span></a></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Raw</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Layout.html"><span class="hs-identifier">Language.LambdaPi.Syntax.Layout</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Raw</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Lex.html"><span class="hs-identifier">Language.LambdaPi.Syntax.Lex</span></a></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Raw</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Par.html"><span class="hs-identifier">Language.LambdaPi.Syntax.Par</span></a></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Raw</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Print.html"><span class="hs-identifier">Language.LambdaPi.Syntax.Print</span></a></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Raw</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">exitFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><span class="hs-comment">-- * Generated code</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">-- ** Scope-safe AST</span></span><span>
</span><span id="line-51"></span><span id="FoilScopedTerm%27"><span id="FoilTerm%27"><span id="FoilPattern%27"><span id="local-6989586621679246741"><span id="local-6989586621679246742"><span id="local-6989586621679246743"><span id="local-6989586621679246807"><span id="local-6989586621679246808"><span id="local-6989586621679246809"><span id="local-6989586621679246811"><span id="local-6989586621679247008"><span id="local-6989586621679247009"><span id="local-6989586621679247010"><span id="FoilPatternWildcard"><span id="FoilPatternVar"><span id="FoilPatternPair"><span id="FoilAScopedTerm"><span id="FoilVar"><span id="FoilPi"><span id="FoilLam"><span id="FoilApp"><span id="FoilProduct"><span id="FoilPair"><span id="FoilFirst"><span id="FoilSecond"><span id="FoilUniverse"><span class="hs-identifier">mkFoilData</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.Term'</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.VarIdent</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.ScopedTerm'</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.Pattern'</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-52"></span><span id="local-6989586621679246741"><span id="local-6989586621679246742"><span id="local-6989586621679246743"><span id="local-6989586621679247025"><span id="local-6989586621679247029"><span id="local-6989586621679247034"><span id="local-6989586621679247045"><span class="hs-identifier">mkInstancesFoil</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.Term'</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.VarIdent</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.ScopedTerm'</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.Pattern'</span></span></span></span></span></span></span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="annot"><span class="hs-comment">-- ** Conversion from raw to scope-safe AST</span></span><span>
</span><span id="line-55"></span><span id="local-6989586621679246741"><span id="local-6989586621679246742"><span id="local-6989586621679246743"><span id="local-6989586621679246824"><span id="local-6989586621679246825"><span id="local-6989586621679246826"><span id="local-6989586621679246827"><span id="local-6989586621679246829"><span id="local-6989586621679246830"><span id="local-6989586621679246831"><span id="local-6989586621679246833"><span id="local-6989586621679246834"><span id="local-6989586621679246839"><span id="local-6989586621679246840"><span id="extendScopeFoilPattern%27"><span id="withRefreshedFoilPattern%27"><span id="toFoilTerm%27"><span id="toFoilPattern%27"><span id="toFoilScopedTerm%27"><span class="hs-identifier">mkToFoil</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.Term'</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.VarIdent</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.ScopedTerm'</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.Pattern'</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><span class="hs-comment">-- ** Conversion from scope-safe to raw AST</span></span><span>
</span><span id="line-58"></span><span id="local-6989586621679246741"><span id="local-6989586621679246742"><span id="local-6989586621679246743"><span id="local-6989586621679246902"><span id="local-6989586621679246904"><span id="local-6989586621679246905"><span id="fromFoilTerm%27"><span id="fromFoilPattern%27"><span id="fromFoilScopedTerm%27"><span class="hs-identifier">mkFromFoil</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.Term'</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.VarIdent</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.ScopedTerm'</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Raw.Pattern'</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">type</span><span> </span><span id="FoilTerm"><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-var">FoilTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm%27"><span class="hs-identifier hs-type">FoilTerm'</span></a></span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#BNFC%27Position"><span class="hs-identifier hs-type">Raw.BNFC'Position</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="FoilPattern"><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPattern"><span class="hs-identifier hs-var">FoilPattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPattern%27"><span class="hs-identifier hs-type">FoilPattern'</span></a></span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#BNFC%27Position"><span class="hs-identifier hs-type">Raw.BNFC'Position</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">-- | Convert a /closed/ scope-safe term into a raw term.</span></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#fromFoilTermClosed"><span class="hs-identifier hs-type">fromFoilTermClosed</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#VarIdent"><span class="hs-identifier hs-type">Raw.VarIdent</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ A stream of fresh variable identifiers.</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">VoidS</span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ A scope safe term in scope @n@.</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#Term"><span class="hs-identifier hs-type">Raw.Term</span></a></span><span>
</span><span id="line-68"></span><span id="fromFoilTermClosed"><span class="annot"><span class="annottext">fromFoilTermClosed :: [VarIdent] -&gt; FoilTerm 'VoidS -&gt; Term
</span><a href="Language.LambdaPi.Impl.FoilTH.html#fromFoilTermClosed"><span class="hs-identifier hs-var hs-var">fromFoilTermClosed</span></a></span></span><span> </span><span id="local-6989586621679247540"><span class="annot"><span class="annottext">[VarIdent]
</span><a href="#local-6989586621679247540"><span class="hs-identifier hs-var">freshVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VarIdent] -&gt; NameMap 'VoidS VarIdent -&gt; FoilTerm 'VoidS -&gt; Term
forall (n :: S) a.
[VarIdent] -&gt; NameMap n VarIdent -&gt; FoilTerm' a n -&gt; Term' a
</span><a href="Language.LambdaPi.Impl.FoilTH.html#fromFoilTerm%27"><span class="hs-identifier hs-var">fromFoilTerm'</span></a></span><span> </span><span class="annot"><span class="annottext">[VarIdent]
</span><a href="#local-6989586621679247540"><span class="hs-identifier hs-var">freshVars</span></a></span><span> </span><span class="annot"><span class="annottext">NameMap 'VoidS VarIdent
forall a. NameMap 'VoidS a
</span><span class="hs-identifier hs-var">emptyNameMap</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246927"><span class="annot"><span class="hs-identifier hs-type">InjectName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm%27"><span class="hs-identifier hs-type">FoilTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621679247547"><span class="annot"><span class="annottext">injectName :: forall (n :: S). Name n -&gt; FoilTerm' a n
</span><a href="#local-6989586621679247547"><span class="hs-identifier hs-var hs-var hs-var hs-var">injectName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Name n -&gt; FoilTerm' a n
forall a (n :: S). a -&gt; Name n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilVar"><span class="hs-identifier hs-var">FoilVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;undefined location&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">-- * User-defined</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><span class="hs-comment">-- ** Substitution</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Perform substitution in a \(\lambda\Pi\)-term.</span></span><span>
</span><span id="line-78"></span><span id="local-6989586621679246929"><span id="local-6989586621679246930"><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-type">substitute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Distinct</span></span><span> </span><span class="annot"><a href="#local-6989586621679246929"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679246929"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Substitution</span></span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246930"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246929"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246930"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246929"><span class="hs-identifier hs-type">o</span></a></span></span></span><span>
</span><span id="line-79"></span><span id="substitute"><span class="annot"><span class="annottext">substitute :: forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var hs-var">substitute</span></a></span></span><span> </span><span id="local-6989586621679247559"><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span id="local-6989586621679247560"><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilVar"><span class="hs-identifier hs-type">FoilVar</span></a></span><span> </span><span id="local-6989586621679247561"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247561"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621679247562"><span class="annot"><span class="annottext">Name i
</span><a href="#local-6989586621679247562"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o -&gt; Name i -&gt; FoilTerm o
forall (e :: S -&gt; *) (i :: S) (o :: S).
InjectName e =&gt;
Substitution e i o -&gt; Name i -&gt; e o
</span><span class="hs-identifier hs-var">lookupSubst</span></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Name i
</span><a href="#local-6989586621679247562"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilApp"><span class="hs-identifier hs-type">FoilApp</span></a></span><span> </span><span id="local-6989586621679247564"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247564"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247565"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247565"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679247566"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247566"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm o -&gt; FoilTerm o -&gt; FoilTerm o
forall a (n :: S).
a -&gt; FoilTerm' a n -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilApp"><span class="hs-identifier hs-var">FoilApp</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247564"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247565"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247566"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilLam"><span class="hs-identifier hs-type">FoilLam</span></a></span><span> </span><span id="local-6989586621679247570"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247570"><span class="hs-identifier hs-var">loc1</span></a></span></span><span> </span><span id="local-6989586621679247571"><span class="annot"><span class="annottext">FoilPattern' BNFC'Position i l
</span><a href="#local-6989586621679247571"><span class="hs-identifier hs-var">pattern</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilAScopedTerm"><span class="hs-identifier hs-type">FoilAScopedTerm</span></a></span><span> </span><span id="local-6989586621679247572"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247572"><span class="hs-identifier hs-var">loc2</span></a></span></span><span> </span><span id="local-6989586621679247573"><span class="annot"><span class="annottext">FoilTerm' BNFC'Position l
</span><a href="#local-6989586621679247573"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scope o
-&gt; FoilPattern' BNFC'Position i l
-&gt; (forall {o' :: S}.
    DExt o o' =&gt;
    (Substitution FoilTerm i o -&gt; Substitution FoilTerm l o')
    -&gt; FoilPattern' BNFC'Position o o' -&gt; FoilTerm o)
-&gt; FoilTerm o
forall a (o :: S) (e :: S -&gt; *) (n :: S) (l :: S) r.
(Distinct o, InjectName e, Sinkable e) =&gt;
Scope o
-&gt; FoilPattern' a n l
-&gt; (forall (o' :: S).
    DExt o o' =&gt;
    (Substitution e n o -&gt; Substitution e l o')
    -&gt; FoilPattern' a o o' -&gt; r)
-&gt; r
</span><a href="Language.LambdaPi.Impl.FoilTH.html#withRefreshedFoilPattern%27"><span class="hs-identifier hs-var">withRefreshedFoilPattern'</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position i l
</span><a href="#local-6989586621679247571"><span class="hs-identifier hs-var">pattern</span></a></span><span> </span><span class="annot"><span class="annottext">((forall {o' :: S}.
  DExt o o' =&gt;
  (Substitution FoilTerm i o -&gt; Substitution FoilTerm l o')
  -&gt; FoilPattern' BNFC'Position o o' -&gt; FoilTerm o)
 -&gt; FoilTerm o)
-&gt; (forall {o' :: S}.
    DExt o o' =&gt;
    (Substitution FoilTerm i o -&gt; Substitution FoilTerm l o')
    -&gt; FoilPattern' BNFC'Position o o' -&gt; FoilTerm o)
-&gt; FoilTerm o
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679247577"><span class="annot"><span class="annottext">Substitution FoilTerm i o -&gt; Substitution FoilTerm l o'
</span><a href="#local-6989586621679247577"><span class="hs-identifier hs-var">extendSubst</span></a></span></span><span> </span><span id="local-6989586621679247578"><span class="annot"><span class="annottext">FoilPattern' BNFC'Position o o'
</span><a href="#local-6989586621679247578"><span class="hs-identifier hs-var">pattern'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247579"><span class="annot"><span class="annottext">subst' :: Substitution FoilTerm l o'
</span><a href="#local-6989586621679247579"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o -&gt; Substitution FoilTerm l o'
</span><a href="#local-6989586621679247577"><span class="hs-identifier hs-var">extendSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-84"></span><span>          </span><span id="local-6989586621679247580"><span class="annot"><span class="annottext">scope' :: Scope o'
</span><a href="#local-6989586621679247580"><span class="hs-identifier hs-var hs-var">scope'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position o o' -&gt; Scope o -&gt; Scope o'
forall a (n :: S) (l :: S).
FoilPattern' a n l -&gt; Scope n -&gt; Scope l
</span><a href="Language.LambdaPi.Impl.FoilTH.html#extendScopeFoilPattern%27"><span class="hs-identifier hs-var">extendScopeFoilPattern'</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position o o'
</span><a href="#local-6989586621679247578"><span class="hs-identifier hs-var">pattern'</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-85"></span><span>          </span><span id="local-6989586621679247581"><span class="annot"><span class="annottext">body' :: FoilTerm o'
</span><a href="#local-6989586621679247581"><span class="hs-identifier hs-var hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scope o'
-&gt; Substitution FoilTerm l o'
-&gt; FoilTerm' BNFC'Position l
-&gt; FoilTerm o'
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o'
</span><a href="#local-6989586621679247580"><span class="hs-identifier hs-var">scope'</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm l o'
</span><a href="#local-6989586621679247579"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm' BNFC'Position l
</span><a href="#local-6989586621679247573"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-86"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BNFC'Position
-&gt; FoilPattern' BNFC'Position o o'
-&gt; FoilScopedTerm' BNFC'Position o'
-&gt; FoilTerm o
forall a (n :: S) (n2 :: S).
a -&gt; FoilPattern' a n n2 -&gt; FoilScopedTerm' a n2 -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilLam"><span class="hs-identifier hs-var">FoilLam</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247570"><span class="hs-identifier hs-var">loc1</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position o o'
</span><a href="#local-6989586621679247578"><span class="hs-identifier hs-var">pattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm o' -&gt; FoilScopedTerm' BNFC'Position o'
forall a (n :: S). a -&gt; FoilTerm' a n -&gt; FoilScopedTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilAScopedTerm"><span class="hs-identifier hs-var">FoilAScopedTerm</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247572"><span class="hs-identifier hs-var">loc2</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm o'
</span><a href="#local-6989586621679247581"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPi"><span class="hs-identifier hs-type">FoilPi</span></a></span><span> </span><span id="local-6989586621679247585"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247585"><span class="hs-identifier hs-var">loc1</span></a></span></span><span> </span><span id="local-6989586621679247586"><span class="annot"><span class="annottext">FoilPattern' BNFC'Position i l
</span><a href="#local-6989586621679247586"><span class="hs-identifier hs-var">pattern</span></a></span></span><span> </span><span id="local-6989586621679247587"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247587"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilAScopedTerm"><span class="hs-identifier hs-type">FoilAScopedTerm</span></a></span><span> </span><span id="local-6989586621679247588"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247588"><span class="hs-identifier hs-var">loc2</span></a></span></span><span> </span><span id="local-6989586621679247589"><span class="annot"><span class="annottext">FoilTerm' BNFC'Position l
</span><a href="#local-6989586621679247589"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scope o
-&gt; FoilPattern' BNFC'Position i l
-&gt; (forall {o' :: S}.
    DExt o o' =&gt;
    (Substitution FoilTerm i o -&gt; Substitution FoilTerm l o')
    -&gt; FoilPattern' BNFC'Position o o' -&gt; FoilTerm o)
-&gt; FoilTerm o
forall a (o :: S) (e :: S -&gt; *) (n :: S) (l :: S) r.
(Distinct o, InjectName e, Sinkable e) =&gt;
Scope o
-&gt; FoilPattern' a n l
-&gt; (forall (o' :: S).
    DExt o o' =&gt;
    (Substitution e n o -&gt; Substitution e l o')
    -&gt; FoilPattern' a o o' -&gt; r)
-&gt; r
</span><a href="Language.LambdaPi.Impl.FoilTH.html#withRefreshedFoilPattern%27"><span class="hs-identifier hs-var">withRefreshedFoilPattern'</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position i l
</span><a href="#local-6989586621679247586"><span class="hs-identifier hs-var">pattern</span></a></span><span> </span><span class="annot"><span class="annottext">((forall {o' :: S}.
  DExt o o' =&gt;
  (Substitution FoilTerm i o -&gt; Substitution FoilTerm l o')
  -&gt; FoilPattern' BNFC'Position o o' -&gt; FoilTerm o)
 -&gt; FoilTerm o)
-&gt; (forall {o' :: S}.
    DExt o o' =&gt;
    (Substitution FoilTerm i o -&gt; Substitution FoilTerm l o')
    -&gt; FoilPattern' BNFC'Position o o' -&gt; FoilTerm o)
-&gt; FoilTerm o
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679247594"><span class="annot"><span class="annottext">Substitution FoilTerm i o -&gt; Substitution FoilTerm l o'
</span><a href="#local-6989586621679247594"><span class="hs-identifier hs-var">extendSubst</span></a></span></span><span> </span><span id="local-6989586621679247595"><span class="annot"><span class="annottext">FoilPattern' BNFC'Position o o'
</span><a href="#local-6989586621679247595"><span class="hs-identifier hs-var">pattern'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247596"><span class="annot"><span class="annottext">subst' :: Substitution FoilTerm l o'
</span><a href="#local-6989586621679247596"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o -&gt; Substitution FoilTerm l o'
</span><a href="#local-6989586621679247594"><span class="hs-identifier hs-var">extendSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-89"></span><span>          </span><span id="local-6989586621679247597"><span class="annot"><span class="annottext">scope' :: Scope o'
</span><a href="#local-6989586621679247597"><span class="hs-identifier hs-var hs-var">scope'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position o o' -&gt; Scope o -&gt; Scope o'
forall a (n :: S) (l :: S).
FoilPattern' a n l -&gt; Scope n -&gt; Scope l
</span><a href="Language.LambdaPi.Impl.FoilTH.html#extendScopeFoilPattern%27"><span class="hs-identifier hs-var">extendScopeFoilPattern'</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position o o'
</span><a href="#local-6989586621679247595"><span class="hs-identifier hs-var">pattern'</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-90"></span><span>          </span><span id="local-6989586621679247598"><span class="annot"><span class="annottext">a' :: FoilTerm o
</span><a href="#local-6989586621679247598"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247587"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-91"></span><span>          </span><span id="local-6989586621679247599"><span class="annot"><span class="annottext">b' :: FoilTerm o'
</span><a href="#local-6989586621679247599"><span class="hs-identifier hs-var hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scope o'
-&gt; Substitution FoilTerm l o'
-&gt; FoilTerm' BNFC'Position l
-&gt; FoilTerm o'
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o'
</span><a href="#local-6989586621679247597"><span class="hs-identifier hs-var">scope'</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm l o'
</span><a href="#local-6989586621679247596"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm' BNFC'Position l
</span><a href="#local-6989586621679247589"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-92"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BNFC'Position
-&gt; FoilPattern' BNFC'Position o o'
-&gt; FoilTerm o
-&gt; FoilScopedTerm' BNFC'Position o'
-&gt; FoilTerm o
forall a (n :: S) (n2 :: S).
a
-&gt; FoilPattern' a n n2
-&gt; FoilTerm' a n
-&gt; FoilScopedTerm' a n2
-&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPi"><span class="hs-identifier hs-var">FoilPi</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247585"><span class="hs-identifier hs-var">loc1</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position o o'
</span><a href="#local-6989586621679247595"><span class="hs-identifier hs-var">pattern'</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm o
</span><a href="#local-6989586621679247598"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm o' -&gt; FoilScopedTerm' BNFC'Position o'
forall a (n :: S). a -&gt; FoilTerm' a n -&gt; FoilScopedTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilAScopedTerm"><span class="hs-identifier hs-var">FoilAScopedTerm</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247588"><span class="hs-identifier hs-var">loc2</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm o'
</span><a href="#local-6989586621679247599"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPair"><span class="hs-identifier hs-type">FoilPair</span></a></span><span> </span><span id="local-6989586621679247600"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247600"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247601"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247601"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679247602"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247602"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm o -&gt; FoilTerm o -&gt; FoilTerm o
forall a (n :: S).
a -&gt; FoilTerm' a n -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPair"><span class="hs-identifier hs-var">FoilPair</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247600"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247601"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247602"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilFirst"><span class="hs-identifier hs-type">FoilFirst</span></a></span><span> </span><span id="local-6989586621679247603"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247603"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247604"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247604"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm o -&gt; FoilTerm o
forall a (n :: S). a -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilFirst"><span class="hs-identifier hs-var">FoilFirst</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247603"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247604"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilSecond"><span class="hs-identifier hs-type">FoilSecond</span></a></span><span> </span><span id="local-6989586621679247605"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247605"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247606"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247606"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm o -&gt; FoilTerm o
forall a (n :: S). a -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilSecond"><span class="hs-identifier hs-var">FoilSecond</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247605"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247606"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilProduct"><span class="hs-identifier hs-type">FoilProduct</span></a></span><span> </span><span id="local-6989586621679247607"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247607"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247608"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247608"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679247609"><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247609"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm o -&gt; FoilTerm o -&gt; FoilTerm o
forall a (n :: S).
a -&gt; FoilTerm' a n -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilProduct"><span class="hs-identifier hs-var">FoilProduct</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247607"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247608"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope o
</span><a href="#local-6989586621679247559"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i o
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm i
</span><a href="#local-6989586621679247609"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilUniverse"><span class="hs-identifier hs-type">FoilUniverse</span></a></span><span> </span><span id="local-6989586621679247610"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247610"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm o
forall a (n :: S). a -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilUniverse"><span class="hs-identifier hs-var">FoilUniverse</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247610"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><span class="hs-comment">-- ** Computation</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><span class="hs-comment">-- | Match a pattern against an expression.</span></span><span>
</span><span id="line-102"></span><span id="local-6989586621679246947"><span id="local-6989586621679246948"><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#matchPattern"><span class="hs-identifier hs-type">matchPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPattern"><span class="hs-identifier hs-type">FoilPattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246947"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246948"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246947"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Substitution</span></span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246948"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246947"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-103"></span><span id="matchPattern"><span class="annot"><span class="annottext">matchPattern :: forall (n :: S) (l :: S).
FoilPattern n l -&gt; FoilTerm n -&gt; Substitution FoilTerm l n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#matchPattern"><span class="hs-identifier hs-var hs-var">matchPattern</span></a></span></span><span> </span><span id="local-6989586621679247613"><span class="annot"><span class="annottext">FoilPattern n l
</span><a href="#local-6989586621679247613"><span class="hs-identifier hs-var">pattern</span></a></span></span><span> </span><span id="local-6989586621679247614"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247614"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FoilPattern n l
-&gt; FoilTerm n
-&gt; Substitution FoilTerm n n
-&gt; Substitution FoilTerm l n
forall (i :: S) (l :: S) (n :: S).
FoilPattern i l
-&gt; FoilTerm n
-&gt; Substitution FoilTerm i n
-&gt; Substitution FoilTerm l n
</span><a href="#local-6989586621679247615"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern n l
</span><a href="#local-6989586621679247613"><span class="hs-identifier hs-var">pattern</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247614"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm n n
forall (e :: S -&gt; *) (i :: S). InjectName e =&gt; Substitution e i i
</span><span class="hs-identifier hs-var">identitySubst</span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679246952"><span id="local-6989586621679246953"><span id="local-6989586621679246954"><span class="annot"><a href="#local-6989586621679247615"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPattern"><span class="hs-identifier hs-type">FoilPattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246952"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246953"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246954"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Substitution</span></span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246952"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246954"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Substitution</span></span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246953"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246954"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679247615"><span class="annot"><span class="annottext">go :: forall (i :: S) (l :: S) (n :: S).
FoilPattern i l
-&gt; FoilTerm n
-&gt; Substitution FoilTerm i n
-&gt; Substitution FoilTerm l n
</span><a href="#local-6989586621679247615"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPatternWildcard"><span class="hs-identifier hs-type">FoilPatternWildcard</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i n -&gt; Substitution FoilTerm i n
Substitution FoilTerm i n -&gt; Substitution FoilTerm l n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="#local-6989586621679247615"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPatternVar"><span class="hs-identifier hs-type">FoilPatternVar</span></a></span><span> </span><span id="local-6989586621679247618"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247618"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621679247619"><span class="annot"><span class="annottext">NameBinder i l
</span><a href="#local-6989586621679247619"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247620"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247620"><span class="hs-identifier hs-var">e</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679247621"><span class="annot"><span class="annottext">Substitution FoilTerm i n
</span><a href="#local-6989586621679247621"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i n
-&gt; NameBinder i l -&gt; FoilTerm n -&gt; Substitution FoilTerm l n
forall (e :: S -&gt; *) (i :: S) (o :: S) (i' :: S).
Substitution e i o -&gt; NameBinder i i' -&gt; e o -&gt; Substitution e i' o
</span><span class="hs-identifier hs-var">addSubst</span></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm i n
</span><a href="#local-6989586621679247621"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">NameBinder i l
</span><a href="#local-6989586621679247619"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247620"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="#local-6989586621679247615"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPatternPair"><span class="hs-identifier hs-type">FoilPatternPair</span></a></span><span> </span><span id="local-6989586621679247623"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247623"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247624"><span class="annot"><span class="annottext">FoilPattern' BNFC'Position i n2
</span><a href="#local-6989586621679247624"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679247625"><span class="annot"><span class="annottext">FoilPattern' BNFC'Position n2 l
</span><a href="#local-6989586621679247625"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247626"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247626"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position n2 l
-&gt; FoilTerm n
-&gt; Substitution FoilTerm n2 n
-&gt; Substitution FoilTerm l n
forall (i :: S) (l :: S) (n :: S).
FoilPattern i l
-&gt; FoilTerm n
-&gt; Substitution FoilTerm i n
-&gt; Substitution FoilTerm l n
</span><a href="#local-6989586621679247615"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position n2 l
</span><a href="#local-6989586621679247625"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm n -&gt; FoilTerm n
forall a (n :: S). a -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilSecond"><span class="hs-identifier hs-var">FoilSecond</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247623"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247626"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Substitution FoilTerm n2 n -&gt; Substitution FoilTerm l n)
-&gt; (Substitution FoilTerm i n -&gt; Substitution FoilTerm n2 n)
-&gt; Substitution FoilTerm i n
-&gt; Substitution FoilTerm l n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position i n2
-&gt; FoilTerm n
-&gt; Substitution FoilTerm i n
-&gt; Substitution FoilTerm n2 n
forall (i :: S) (l :: S) (n :: S).
FoilPattern i l
-&gt; FoilTerm n
-&gt; Substitution FoilTerm i n
-&gt; Substitution FoilTerm l n
</span><a href="#local-6989586621679247615"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position i n2
</span><a href="#local-6989586621679247624"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm n -&gt; FoilTerm n
forall a (n :: S). a -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilFirst"><span class="hs-identifier hs-var">FoilFirst</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247623"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247626"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Compute weak head normal form (WHNF).</span></span><span>
</span><span id="line-111"></span><span id="local-6989586621679246965"><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-type">whnf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Distinct</span></span><span> </span><span class="annot"><a href="#local-6989586621679246965"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679246965"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246965"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246965"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-112"></span><span id="whnf"><span class="annot"><span class="annottext">whnf :: forall (n :: S). Distinct n =&gt; Scope n -&gt; FoilTerm n -&gt; FoilTerm n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-var hs-var">whnf</span></a></span></span><span> </span><span id="local-6989586621679247633"><span class="annot"><span class="annottext">Scope n
</span><a href="#local-6989586621679247633"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilApp"><span class="hs-identifier hs-type">FoilApp</span></a></span><span> </span><span id="local-6989586621679247634"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247634"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247635"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247635"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679247636"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247636"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Scope n -&gt; FoilTerm n -&gt; FoilTerm n
forall (n :: S). Distinct n =&gt; Scope n -&gt; FoilTerm n -&gt; FoilTerm n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-var">whnf</span></a></span><span> </span><span class="annot"><span class="annottext">Scope n
</span><a href="#local-6989586621679247633"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247635"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-115"></span><span>      </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilLam"><span class="hs-identifier hs-type">FoilLam</span></a></span><span> </span><span id="local-6989586621679247639"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247639"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621679247640"><span class="annot"><span class="annottext">FoilPattern' BNFC'Position n l
</span><a href="#local-6989586621679247640"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilAScopedTerm"><span class="hs-identifier hs-type">FoilAScopedTerm</span></a></span><span> </span><span id="local-6989586621679247641"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247641"><span class="hs-identifier hs-var">_loc'</span></a></span></span><span> </span><span id="local-6989586621679247642"><span class="annot"><span class="annottext">FoilTerm' BNFC'Position l
</span><a href="#local-6989586621679247642"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247643"><span class="annot"><span class="annottext">subst :: Substitution FoilTerm l n
</span><a href="#local-6989586621679247643"><span class="hs-identifier hs-var hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position n l
-&gt; FoilTerm n -&gt; Substitution FoilTerm l n
forall (n :: S) (l :: S).
FoilPattern n l -&gt; FoilTerm n -&gt; Substitution FoilTerm l n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#matchPattern"><span class="hs-identifier hs-var">matchPattern</span></a></span><span> </span><span class="annot"><span class="annottext">FoilPattern' BNFC'Position n l
</span><a href="#local-6989586621679247640"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247636"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-117"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Scope n -&gt; FoilTerm n -&gt; FoilTerm n
forall (n :: S). Distinct n =&gt; Scope n -&gt; FoilTerm n -&gt; FoilTerm n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-var">whnf</span></a></span><span> </span><span class="annot"><span class="annottext">Scope n
</span><a href="#local-6989586621679247633"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope n
-&gt; Substitution FoilTerm l n
-&gt; FoilTerm' BNFC'Position l
-&gt; FoilTerm n
forall (o :: S) (i :: S).
Distinct o =&gt;
Scope o -&gt; Substitution FoilTerm i o -&gt; FoilTerm i -&gt; FoilTerm o
</span><a href="Language.LambdaPi.Impl.FoilTH.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Scope n
</span><a href="#local-6989586621679247633"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution FoilTerm l n
</span><a href="#local-6989586621679247643"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm' BNFC'Position l
</span><a href="#local-6989586621679247642"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>      </span><span id="local-6989586621679247644"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247644"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm n -&gt; FoilTerm n -&gt; FoilTerm n
forall a (n :: S).
a -&gt; FoilTerm' a n -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilApp"><span class="hs-identifier hs-var">FoilApp</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247634"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247644"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247636"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilFirst"><span class="hs-identifier hs-type">FoilFirst</span></a></span><span> </span><span id="local-6989586621679247645"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247645"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247646"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247646"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Scope n -&gt; FoilTerm n -&gt; FoilTerm n
forall (n :: S). Distinct n =&gt; Scope n -&gt; FoilTerm n -&gt; FoilTerm n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-var">whnf</span></a></span><span> </span><span class="annot"><span class="annottext">Scope n
</span><a href="#local-6989586621679247633"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247646"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-121"></span><span>      </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPair"><span class="hs-identifier hs-type">FoilPair</span></a></span><span> </span><span id="local-6989586621679247647"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247647"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621679247648"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247648"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679247649"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247649"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scope n -&gt; FoilTerm n -&gt; FoilTerm n
forall (n :: S). Distinct n =&gt; Scope n -&gt; FoilTerm n -&gt; FoilTerm n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-var">whnf</span></a></span><span> </span><span class="annot"><span class="annottext">Scope n
</span><a href="#local-6989586621679247633"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247648"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-122"></span><span>      </span><span id="local-6989586621679247650"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247650"><span class="hs-identifier hs-var">t'</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm n -&gt; FoilTerm n
forall a (n :: S). a -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilFirst"><span class="hs-identifier hs-var">FoilFirst</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247645"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247650"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilSecond"><span class="hs-identifier hs-type">FoilSecond</span></a></span><span> </span><span id="local-6989586621679247651"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247651"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679247652"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247652"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Scope n -&gt; FoilTerm n -&gt; FoilTerm n
forall (n :: S). Distinct n =&gt; Scope n -&gt; FoilTerm n -&gt; FoilTerm n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-var">whnf</span></a></span><span> </span><span class="annot"><span class="annottext">Scope n
</span><a href="#local-6989586621679247633"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247652"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilPair"><span class="hs-identifier hs-type">FoilPair</span></a></span><span> </span><span id="local-6989586621679247653"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247653"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621679247654"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247654"><span class="hs-identifier hs-var">_l</span></a></span></span><span> </span><span id="local-6989586621679247655"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247655"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scope n -&gt; FoilTerm n -&gt; FoilTerm n
forall (n :: S). Distinct n =&gt; Scope n -&gt; FoilTerm n -&gt; FoilTerm n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-var">whnf</span></a></span><span> </span><span class="annot"><span class="annottext">Scope n
</span><a href="#local-6989586621679247633"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247655"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span id="local-6989586621679247656"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247656"><span class="hs-identifier hs-var">t'</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BNFC'Position -&gt; FoilTerm n -&gt; FoilTerm n
forall a (n :: S). a -&gt; FoilTerm' a n -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#FoilSecond"><span class="hs-identifier hs-var">FoilSecond</span></a></span><span> </span><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247651"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247656"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679247657"><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247657"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FoilTerm n
</span><a href="#local-6989586621679247657"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><span class="hs-comment">-- ** Interpreter</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><span class="hs-comment">-- | Interpret a \(\lambda\Pi\) command.</span></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#interpretCommand"><span class="hs-identifier hs-type">interpretCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#Command"><span class="hs-identifier hs-type">Raw.Command</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span id="interpretCommand"><span class="annot"><span class="annottext">interpretCommand :: Command -&gt; IO ()
</span><a href="Language.LambdaPi.Impl.FoilTH.html#interpretCommand"><span class="hs-identifier hs-var hs-var">interpretCommand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#CommandCompute"><span class="hs-identifier hs-type">Raw.CommandCompute</span></a></span><span> </span><span id="local-6989586621679247660"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247660"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621679247661"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621679247661"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621679247662"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621679247662"><span class="hs-identifier hs-var">_type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &#8614; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FoilTerm 'VoidS -&gt; String
</span><a href="Language.LambdaPi.Impl.FoilTH.html#printFoilTerm"><span class="hs-identifier hs-var">printFoilTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope 'VoidS -&gt; FoilTerm 'VoidS -&gt; FoilTerm 'VoidS
forall (n :: S). Distinct n =&gt; Scope n -&gt; FoilTerm n -&gt; FoilTerm n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#whnf"><span class="hs-identifier hs-var">whnf</span></a></span><span> </span><span class="annot"><span class="annottext">Scope 'VoidS
</span><span class="hs-identifier hs-var">emptyScope</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scope 'VoidS
-&gt; Map VarIdent (Name 'VoidS) -&gt; Term -&gt; FoilTerm 'VoidS
forall (n :: S) a.
Distinct n =&gt;
Scope n -&gt; Map VarIdent (Name n) -&gt; Term' a -&gt; FoilTerm' a n
</span><a href="Language.LambdaPi.Impl.FoilTH.html#toFoilTerm%27"><span class="hs-identifier hs-var">toFoilTerm'</span></a></span><span> </span><span class="annot"><span class="annottext">Scope 'VoidS
</span><span class="hs-identifier hs-var">emptyScope</span></span><span> </span><span class="annot"><span class="annottext">Map VarIdent (Name 'VoidS)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621679247661"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- #TODO: add typeCheck</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#interpretCommand"><span class="hs-identifier hs-var">interpretCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#CommandCheck"><span class="hs-identifier hs-type">Raw.CommandCheck</span></a></span><span> </span><span id="local-6989586621679247668"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247668"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621679247669"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621679247669"><span class="hs-identifier hs-var">_term</span></a></span></span><span> </span><span id="local-6989586621679247670"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621679247670"><span class="hs-identifier hs-var">_type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Not yet implemented&quot;</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><span class="hs-comment">-- | Interpret a \(\lambda\Pi\) program.</span></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#interpretProgram"><span class="hs-identifier hs-type">interpretProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#Program"><span class="hs-identifier hs-type">Raw.Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span id="interpretProgram"><span class="annot"><span class="annottext">interpretProgram :: Program -&gt; IO ()
</span><a href="Language.LambdaPi.Impl.FoilTH.html#interpretProgram"><span class="hs-identifier hs-var hs-var">interpretProgram</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.LambdaPi.Syntax.Abs.html#AProgram"><span class="hs-identifier hs-type">Raw.AProgram</span></a></span><span> </span><span id="local-6989586621679247673"><span class="annot"><span class="annottext">BNFC'Position
</span><a href="#local-6989586621679247673"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621679247674"><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679247674"><span class="hs-identifier hs-var">typedTerms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Command -&gt; IO ()) -&gt; [Command] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Command -&gt; IO ()
</span><a href="Language.LambdaPi.Impl.FoilTH.html#interpretCommand"><span class="hs-identifier hs-var">interpretCommand</span></a></span><span> </span><span class="annot"><span class="annottext">[Command]
</span><a href="#local-6989586621679247674"><span class="hs-identifier hs-var">typedTerms</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | Default interpreter program.</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- Reads a \(\lambda\Pi\) program from the standard input and runs the commands.</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#defaultMain"><span class="hs-identifier hs-type">defaultMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span id="defaultMain"><span class="annot"><span class="annottext">defaultMain :: IO ()
</span><a href="Language.LambdaPi.Impl.FoilTH.html#defaultMain"><span class="hs-identifier hs-var hs-var">defaultMain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679247676"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247676"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getContents</span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Err Program
</span><a href="Language.LambdaPi.Syntax.Par.html#pProgram"><span class="hs-identifier hs-var">Raw.pProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; [Token] -&gt; [Token]
</span><a href="Language.LambdaPi.Syntax.Layout.html#resolveLayout"><span class="hs-identifier hs-var">Raw.resolveLayout</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [Token]
</span><a href="Language.LambdaPi.Syntax.Lex.html#tokens"><span class="hs-identifier hs-var">Raw.tokens</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247676"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679247681"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247681"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247681"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679247682"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679247682"><span class="hs-identifier hs-var">program</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Program -&gt; IO ()
</span><a href="Language.LambdaPi.Impl.FoilTH.html#interpretProgram"><span class="hs-identifier hs-var">interpretProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679247682"><span class="hs-identifier hs-var">program</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><span class="hs-comment">-- ** Pretty-printing</span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Pretty-print a /closed/ scode-safe \(\lambda\Pi\)-term</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- using BNFC-generated printer (via 'Raw.Term').</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#printFoilTerm"><span class="hs-identifier hs-type">printFoilTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.LambdaPi.Impl.FoilTH.html#FoilTerm"><span class="hs-identifier hs-type">FoilTerm</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">VoidS</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-159"></span><span id="printFoilTerm"><span class="annot"><span class="annottext">printFoilTerm :: FoilTerm 'VoidS -&gt; String
</span><a href="Language.LambdaPi.Impl.FoilTH.html#printFoilTerm"><span class="hs-identifier hs-var hs-var">printFoilTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; String
forall a. Print a =&gt; a -&gt; String
</span><a href="Language.LambdaPi.Syntax.Print.html#printTree"><span class="hs-identifier hs-var">Raw.printTree</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; String)
-&gt; (FoilTerm 'VoidS -&gt; Term) -&gt; FoilTerm 'VoidS -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[VarIdent] -&gt; FoilTerm 'VoidS -&gt; Term
</span><a href="Language.LambdaPi.Impl.FoilTH.html#fromFoilTermClosed"><span class="hs-identifier hs-var">fromFoilTermClosed</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; VarIdent
</span><a href="Language.LambdaPi.Syntax.Abs.html#VarIdent"><span class="hs-identifier hs-var">Raw.VarIdent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679247686"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679247686"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679247686"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-161"></span></pre></body></html>